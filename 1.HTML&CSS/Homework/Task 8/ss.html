<!DOCTYPE html>
<html>
<head>
	<title>Работа с SSH</title>
	<meta charset="utf-8">
	<link rel="stylesheet" type="text/css" href="css/reset.css">
	<link rel="stylesheet" type="text/css" href="style/my.css">
</head>
<body>

	<img src="img/tiny.cc.png" alt="цтф-пони" title="цтф-пони"><br>

    <a href="https://google.com">google</a><br>
	<a href="https://yandex.ua">yandex</a><br>
	<a href="https://gmail.com">nnm</a><br>
	<a href="https://nnm.com">nnm</a><br>
	<a href="https://cnn.com">nnm</a><br>

    <br>
	<img src="img/конь.jpg" alt="конь-кочок" title="конь-кочок"><br>


	<h1>Руководство по команде SSH в Linux с примерами</h1>


<p>SSH (Secure Shell) - это сетевой протокол, который обеспечивает безопасное удаленное соединение между двумя системами. Системные администраторы используют утилиты SSH для управления компьютерами, копирования или перемещения файлов между системами. Поскольку SSH передает данные по зашифрованным каналам, безопасность находится на высоком уровне.</p>

<h2>Установка клиента OpenSSH</h2>

<p>Есть много SSH-клиентов, бесплатных и платных, и OpenSSH является наиболее широко используемым клиентом. Он доступен на всех основных платформах, включая Linux, OpenBSD, Windows и macOS. Клиент OpenSSH предустановлен в большинстве дистрибутивов Linux по умолчанию, однако если в вашей системе не установлен клиент ssh, вы можете установить его с помощью диспетчера пакетов.</p>

<p>sudo apt install openssh-client</p>

<h2>Как получить доступ к удаленному серверу</h2>

<p>Для подключения к удаленному компьютеру вам потребуется его IP-адрес или имя. Загрузите терминал или любой SSH-клиент и введите ssh, а затем 
IP-адрес:</p>

<p>ssh 192.168.56.101</p>

<p>или имя:</p>

<p>ssh test.server.com</p>

<p>При первом подключении к хосту вы увидите следующее сообщение:</p>

<p>Введите yes и нажмите Enter. Возможно, вам также потребуется ввести свой пароль.</p>

<h2>Укажите имя пользователя для SSH-подключения</h2>

<p>SSH использует текущего пользователя при доступе к удаленному серверу. Чтобы указать пользователя для SSH-соединения, выполните команду в следующем формате:</p>

<p>ssh username@hostname_or_ip</p>

<p>Например:</p>

<p>ssh testuser@10.0.0.55</p>

<p>Примечание. Если вы столкнулись с ошибкой «Connection refused», обратитесь к нашему руководству, чтобы найти решения.</p>   

<h2>Используйте другой номер порта для SSH-соединения</h2>

<p>По умолчанию сервер SSH прослушивает соединение на порту 22. Если настройка порта в файле конфигурации SSH была изменена, вам необходимо указать порт. В противном случае вы получите такую ошибку:</p>

<p>«Connection refused»</p>

<p>Чтобы подключиться к удаленному хосту с настраиваемым номером порта SSH, используйте флаг -p. Например:</p>

<p>ssh test.server.com -p 3322</p>

<h2>Генерация ключей SSH с помощью SSH Keygen</h2>

<p>Чтобы повысить безопасность соединений SSH, сгенерируйте пару ключей с помощью утилиты keygen. Пара состоит из открытого и закрытого ключей. Открытый ключ может быть общим, а закрытый ключ должен оставаться в безопасности.</p>

<p>Пары ключей SSH используются для автоматической аутентификации клиентов на серверах. Когда вы создаете пару ключей SSH, больше не нужно вводить пароль для доступа к серверу.</p>

<p>На терминале хост-машины используйте эту команду для создания пары ключей:</p>

<p>ssh-keygen -t rsa</p>

<p>Чтобы использовать настройки по умолчанию, нажмите Enter в ответ на запрос местоположения файла и парольной фразы.</p>

<h2>Копировать открытый ключ SSH</h2>

<p>Чтобы использовать пару ключей для аутентификации SSH, вам необходимо скопировать открытый ключ на сервер. Ключ - это файл id_rsa.pub, ранее созданный с помощью утилиты генерации ключей SSH.</p>

<p>Чтобы скопировать ключ на сервер, запустите эту команду на клиенте:</p>

<p>ssh-copy-id hostname_or_IP</p>

<p>Вы также можете указать имя пользователя, если не хотите использовать текущего пользователя.</p>

<p>Введите пароль для аутентификации, когда его спросят. После этого вам больше не нужно будет использовать пароль для подключения к тому же серверу.</p>

<h2>Копирование файла удаленно через SSH с помощью SCP</h2>

<p>Вы можете безопасно копировать файлы по протоколу SSH с помощью инструмента SCP. Базовый синтаксис:</p>

<p>scp fileName user@remotehost:/home/username/destination</p>

<p>Например, чтобы скопировать файл sample3 на рабочий стол на удаленном сервере с проверкой имени пользователя, введите:</p>

<p>scp sample3 test@10.0.10.5:/home/test/Desktop</p>

<p>Выходные данные показывают сводку операции.</p>

<p>Обязательно используйте флаг -P в верхнем регистре, если вам нужно указать порт.</p>

<h2>Редактировать файл конфигурации SSH</h2>

<p>Вы можете контролировать, как удаленные пользователи могут получить доступ к серверу через SSH. Измените настройки в файле sshd_config, чтобы настроить параметры сервера SSH. Обязательно редактируйте только те параметры, которые вам знакомы. Сервер может стать недоступным из-за неправильной конфигурации.</p>

<p>Используйте любой редактор по вашему выбору, чтобы отредактировать файл. Для внесения изменений вам потребуются права суперпользователя. В Linux мы используем vim.</p>

<p>В командной строке на удаленном хосте введите:</p>

<p>sudo vim /etc/ssh/sshd_config</p>

<p>Введите пароль sudo, и оболочка откроет файл в редакторе, который вы использовали.</p>

<h2>Перезапустить службу SSH</h2>

<p>Когда вы вносите изменения в конфигурацию SSH, вам нужно будет перезапустить службу в Linux.</p>

<p>В зависимости от дистрибутива Linux выполните одну из следующих команд на машине, на которой вы изменили настройки:</p>

<p>sudo ssh service restart</p>

<p>или:</p>

<p>sudo sshd service restart</p>

<p>Наконец, введите пароль, чтобы завершить процесс. В результате в следующем сеансе SSH будут использоваться новые настройки.</p>

<h2>Выполнение команды на удаленном сервере с локального компьютера</h2>

<p>Этот метод не создает новую оболочку. Вместо этого он запускает команду и возвращает пользователя в локальную подсказку. Вы можете создать файл, скопировать файлы или запустить любую другую команду SSH в этом формате.</p>

<p>Чтобы удаленно выполнить команду с локального компьютера, добавьте инструкцию к команде SSH. Например, чтобы удалить файл, введите:</p>

<p>ssh test.server.com rm ~/Desktop/Dir1/sample4</p>

<p>Введите пароль, и файл на удаленном сервере будет удален без создания новой оболочки.</p>

<h2>Параметры командной строки SSH</h2>

<p>Инструмент SSH имеет множество дополнительных параметров. Ниже перечислены общие параметры SSH и соответствующие описания.</p>

<ul>
    <li>-1 - указывает ssh использовать версию протокола 1</li>
    <li>-2 - указывает ssh использовать протокол версии 2.</li>
    <li>-4 - разрешает только адреса IPv4.</li>
    <li>-6 - разрешает только адреса IPv6.</li>
    <li>-A - включает переадресацию соединения агента аутентификации. Используйте эту опцию с осторожностью.</li>
    <li>-a - Отключает переадресацию соединения агента аутентификации.</li>
    <li>-b bind_address - используйте эту опцию на локальном хосте с более чем одним адресом, чтобы установить исходный адрес соединения.</li>
    <li>-C - включает сжатие данных для всех файлов. Только для использования с медленными соединениями.</li>
    <li>-c cipher_spec - используется для выбора спецификации шифра. Перечислите значения через запятую.</li>
    <li>-E log_fileName - прикрепляет журналы отладки к log_file вместо стандартной ошибки.</li>
    <li>-f - отправляет ssh в фоновый режим даже до ввода пароля или ключевой фразы.</li>
    <li>-g - Разрешает удаленным хостам подключаться к портам, перенаправленным на локальном компьютере.</li>
    <li>-q - запускает ssh в тихом режиме. Он подавляет большинство сообщений об ошибках и предупреждениях.</li>
    <li>-V - отображает версию инструмента ssh и завершает работу.</li>
    <li>-v - печатает отладочные сообщения для ssh-соединения. Подробный режим полезен при устранении неполадок конфигурации.</li>
    <li>-X - Используйте этот параметр, чтобы включить пересылку X11.</li>
    <li>-x - Отключить пересылку X11.</li>
    
</ul>
</body>
</html>